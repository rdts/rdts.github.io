<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1,shrink-to-fit=no">
	<title>Surfcams</title>
	
	<link href="https://vjs.zencdn.net/7.8.4/video-js.css" rel="stylesheet" />
  
	<style>
		#camcontainer { position: relative; width: 100%; padding-bottom: 56%; }
		#camselect { font-weight:bold; font-size:14px; }
		#message {font-weight:bold; font-size:14px; }
	</style>
       
	<script src="https://vjs.zencdn.net/7.8.4/video.js"></script>

	
</head>


<body>
	<select id="camselect" onchange="changecam()" > <--- this is function in .js
		<option value="hbss"> HB Pier South </option>
		<option value="elporto"> El Porto </option>
		<option value="elportoclose"> El Porto Close-Up </option>
		<option value="elportofixed"> El Porto North </option>
		<!-- <option value="4203"> County Line </option> -->
		<!-- <option value="135846"> County Line Overview </option> -->
		<!-- <option value="4223"> HB Pier North </option> -->
		<option value="cstreetov"> C Street </option>
		<option value="venturapoint"> Ventura Point </option>
		<option value="malibu"> Malibu </option>
		<option value="topangaclose"> Topanga </option>
		<option value="zumaov"> Zuma </option>
		<option value="saltcreek"> Salt Creek </option>
		<option value="tstreet"> T Street </option>
		<option value="morro"> Morro Bay </option>
		<!-- <option value="4188"> Steamer Lane </option> -->
		<!-- <option value="4152"> Mavericks </option> -->
		<!-- <option value="4750"> Pipeline </option> -->
		<option value="pipelineov"> Pipeline Overview </option>
		<!-- <option value="4751"> Backdoor </option> -->
		<!-- <option value="133984"> Backdoor Overview </option> -->
		<option value="sunsetpoint"> Sunset </option>
		<option value="waimea"> Waimea Bay </option>
		<option value="waimeabaysb"> Waimea Overview </option>
	</select>
	<br>
	<div id="message"> </div>
	<div id="vidcontainer">
		<video-js id="video" calss="video-js" preload="auto" width="100%" autoplay="autoplay" muted="muted" data-setup='{"liveui": true}'>
			<source src="https://cams.cdn-surfline.com/cdn-wc/wc-hbss/chunklist.m3u8" type="application/x-mpegurl">
		</video-js>
	</div>
	<div id="player"></div>

<script scr="surf/libs/bootstrap.min.js"></script>
<!-- <script scr="surf/libs/jquery.min.js"></script> -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script src="http://cdn.jsdelivr.net/npm/hls.js@latest"></script>



<script>

//var video = videojs('video');
//video.play();

function playM3U8(src){
	console.log("calling playM3U8byNative");
	//if(isMobile()){
		playM3U8byNative(src);
	//}else{
	//	playM3U8byHlsJS(src);
	//}
}

function isMobile(){
	return(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));
}

function playM3U8byNative(src){
	vidcontainer = document.getElementById('vidcontainer');
	console.log("replacing video container html");
	video.setAttribute("src", src);
	vidcontainer.innerHTML = ' \
		<video id="video" width="100%" controls autoplay="autoplay" muted="muted"> \
		<source src="'+src+'" type="application/x-mpegurl"> \
		<source src="'+src+'" type="application/vnd.apple.mpegurl"> \
		<source src="'+src+'" type="video/mp4"> \
		Your browser does not support the video tag. \
		</video>';
	console.log("loading sources");
	video.load();
	console.log("trying to play video");
	video.play();
}

function playM3U8byHlsJS(src){
	console.log("playM3U8byHlsJS:  playing source: " + src);
	var video = document.getElementById('video');
	var hls = new Hls();
	hls.attachMedia(video);
	hls.on(Hls.Events.MEDIA_ATTACHED, function(){
		console.log("video and hls.js are now bound together");
		hls.loadSource(src);
		hls.on(Hls.Events.MANIFEST_PARSED,function(event,data){
			console.log("manifest loaded, found "+data.levels.length+" quality level");
			video.play();
		});
	});
	hls.on(Hls.Events.ERROR, function (event, data) {
		console.log("hls error:  " + data.details);
		message.innerText = "hls error:  " + data.details;
		console.log(event);
		console.log(data);
	});
}

function changecam() {
	var cammenu = document.getElementById('camselect');
	var camname = cammenu.options[cammenu.selectedIndex].value;
	vidurl = "https://cams.cdn-surfline.com/cdn-wc/wc-" + camname + "/chunklist.m3u8";
	playM3U8(vidurl);
}
	

</script>




</body>
</html>